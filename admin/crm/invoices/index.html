<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <title>Integra</title>
    <link rel="icon" type="image/png" href="/resources/img/icon.png">

    <meta name="subject" content="">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="copyright" content="">
    <meta name="author" content="">
    <meta name="designer" content="">
    <meta name="publisher" content="">
    <meta name="distribution" content="Global">

    <!-- Mobile meta -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!-- CSS StylSheets -->
    <link rel="stylesheet" type="text/css" href="/resources/css/style.css">
    <link rel="stylesheet" type="text/css" href="/resources/css/buttons.css">
    <link rel="stylesheet" type="text/css" href="/resources/css/flexbox.css">
    <link rel="stylesheet" type="text/css" href="/resources/css/queries.css">
    <link href="/resources/assets/fontawesome/css/all.css" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>

    <header>
        <div id="header-wrap">
            <div id="menu-btn-container" class="cursor-pointer">
                <div id="menu-btn" onclick="toggleMenu()">
                    <div id="bar1"></div>
                    <div id="bar2"></div>
                    <div id="bar3"></div>
                </div>
            </div>
            <div id="header-logo">
                <div id='logo-slider'>
                    <img id="logo1" src="/resources/img/logo.svg" alt="">
                </div>
            </div>
            <div id="user-container">
                <div>
                    <div onclick="logoutFunction()" id="log-out-btn">Log-out <i class="fas fa-sign-out-alt"></i></div>
                </div>
            </div>
        </div>
    </header>
    <div id="notification-corner">
        
    </div>
    <div id="page-body">
        <div id="menu-wrap" class="menu-inactive">
            <div id="menu-container">
                <nav id="navigation">
                    <ul id="navigation-ul">
                        <li class="navigation-ul-li">
                            <a class="navigation-ul-li-a" href="/admin/"><i class="fa-solid fa-house-chimney"></i>&nbsp;Home</a>
                        </li>
                        <hr>
                        <li class="navigation-ul-li">
                            <a class="navigation-ul-li-a" href="/admin/clients/"><i class="fa-solid fa-user-tie"></i>&nbsp;Clients</a>
                        </li>
                        <hr>
                        <li class="navigation-ul-li">
                            <a class="navigation-ul-li-a" href="/admin/media-plan/"><i class="fa-solid fa-photo-film"></i>&nbsp;Media plan</a>
                        </li>
                        <hr>
                        <li class="navigation-ul-li">
                            <a class="navigation-ul-li-a" href="/admin/tasks/"><i class="fa-solid fa-list-check"></i>&nbsp;Tasks</a>
                        </li>
                        <hr>
                        <li class="navigation-ul-li">
                            <a class="navigation-ul-li-a" href="#"><i class="fa-solid fa-people-arrows-left-right"></i>&nbsp;CRM</a>
                            
                            <ul id="crm-submenu">
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/crm/"><i class="fa-solid fa-list-ul"></i>&nbsp;To do</a>
                                </li>
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/crm/clients/"><i class="fa-solid fa-user-tie"></i>&nbsp;Clients</a>
                                </li>
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/crm/proforme/"><i class="fa-solid fa-receipt"></i>&nbsp;Proforms</a>
                                </li>
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/crm/invoices/"><i class="fa-solid fa-file-invoice-dollar"></i>&nbsp;Invoices</a>
                                </li>
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/crm/xml-to-pdf/"><i class="fa-solid fa-file-invoice-dollar"></i>&nbsp;XML to PDF</a>
                                </li>
                            </ul>
                            
                        </li>
                        <hr>
                        <li class="navigation-ul-li">
                            <a class="navigation-ul-li-a" href="#"><i class="fa-solid fa-gear"></i>&nbsp;Settings</a>
                            
                            <ul id="settings-submenu">
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/admins/"><i class="fa-solid fa-user-gear"></i>&nbsp;Admins</a>
                                </li>
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/roles"><i class="fa-solid fa-star"></i>&nbsp;Roles</a>
                                </li>
                                <li class="navigation-ul-li">
                                    <a class="navigation-ul-li-a" href="/admin/account-settings/"><i class="fa-solid fa-sliders"></i>&nbsp;Account settings</a>
                                </li>
                            </ul>
                        </li>
                        <hr>
                    </ul>
                </nav>
            </div>
        </div>

        <div id="page-wrap" class="page-wrap-inactive-menu">
            <div id="page-container">
                
                
                <div class="crm-info-box-header">
                    <div>
                        <h1>Facturi</h1>
                    </div>
                    <div>
                        <div onclick="newProforma()" class="crm-long-btn" style="background-color: #6baa41;">
                            <i class="fa-solid fa-plus"></i>&nbsp;Factura noua
                        </div>
                    </div>
                </div>

                <div style="display:flex;align-items:center;">
                    <i class="fa-solid fa-magnifying-glass"></i>&nbsp;&nbsp;
                    <div class="input-container">
                        <select id="emitor-filter" onchange="filterTable();">
                            <option value="all" selected>Emitor</option>
                            <option value="1" >diagency</option>
                            <option value="2" >diclick</option>
                        </select>
                    </div>&nbsp;&nbsp;
                    <div class="input-container">
                        <input id="client-filter" type="text" oninput="filterTable();" placeholder="Client">
                    </div>&nbsp;&nbsp;
                    <div class="input-container">
                        <input id="number-filter" type="text" oninput="filterTable();" placeholder="Nr. factura">
                    </div>&nbsp;&nbsp;
                    <div class="input-container">
                        <input id="date-filter" type="month" oninput="filterTable();" placeholder="Luna emitere">
                    </div>
                </div>

                <div>
                    <table  class="client-file-table">
                        <thead>
                            <tr>
                                <th>Data emitere</th>
                                <th>Emitent</th>
                                <th>Client</th>
                                <th>Nr. factura</th>
                                <th>Valoare totala</th>
                                <th>Status</th>
                                <th>Actiuni</th>
                            </tr>
                        </thead>
                        <tbody id="proforme-table-list">
                            <tr>
                                <td>"+response.dataEmitere+"</td>
                                <td>"+response.emitor+"</td>
                                <td>"+response.client+"</td>
                                <td>"+response.nrFactura+"</td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
            </div>
        </div>

    </div>
    <footer style="height: 20px; background-color: #444; color:#fff;">
        <p style='text-align: center;'>Copyright Social Marketing Platform S.R.L.</p>
    </footer>

    <div id="modal-new-proforma" class="modal">
        <div class="form-box">
            <div class="form-container">
                <div class='btns-box'>
                    <div>
                       
                    </div>
                    <i onclick='closeNewProforma()' class='fas fa-times'></i>
                </div>
                <div id='view-complete-action-content'>
                    <div>
                        <h1 style="text-align:center">Factura noua</h1>
                       <form action="" method="POST" id="crm-generate-proforma">
                            <div class='form-row-wrap'>
                                <div class="input-container">
                                    <label>Emitent</label>
                                    <select name="new-proforma-emitator" id="new-proforma-emitator" required>
                                        <option value="" selected disabled>Emitent</option>
                                        <option value="1">d+i Activation</option>
                                        <option value="2">di click</option>
                                    </select>
                                </div>
                                <div class="input-container">
                                    <label>Client</label>
                                    <select name="new-proforma-client" id="new-proforma-client" required>

                                    </select>
                                </div>
                            </div>
                            <div class='form-row-wrap'>
                                <div class="input-container">
                                    <label>Numar factura</label>
                                    <input type="text" name='new-proforma-invoice-number' id='new-proforma-invoice-number' readonly >
                                </div>
                                <div class="input-container">
                                    <label>Termen de plata</label>
                                    <input type="date" name="new-proforma-tp" id="new-proforma-tp" required>
                                </div>
                            </div>
                            <div class='form-row-wrap'>    
                                <div class="input-container">
                                    <label>TVA (%)</label>
                                    
                                    <input type="number" value="19" name='new-proforma-vat' id='new-proforma-vat' required>
                                </div>
                            </div>
                            <div>
                                <table class="client-file-table">
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>Nr. crt.</th>
                                            <th>Denumire produs</th>
                                            <th>UM</th>
                                            <th>Cantitate</th>
                                            <th>Pret unitar (fara TVA)</th>
                                            <th>Valoare fara tva</th>
                                            <th>TVA</th> 
                                        </tr>
                                    </thead>
                                    <tbody id='products-list'>
                                        <td>
                                            <div onclick='removeProduct(\""+productIndex+"\")'><i class='fa-solid fa-xmark'></i></div>
                                        </td>
                                        <td>"+(productIndex+1)+"</td>
                                        <td>
                                            <input type='text' name='product-name[]' class='product-name' value="" onchange='nameChange(\""+productIndex+"\")'>
                                        </td>
                                        <td>
                                            <input type='text' name='product-um[]' class='product-um' onchange='umChange(\""+productIndex+"\")'>
                                        </td>
                                        <td>
                                            <input type='number' min='0' name='product-cant[]' class='product-cant' onchange='cantChange(\""+productIndex+"\")'>
                                        </td>
                                        <td>
                                            <input type='text' name='product-price[]' class='product-price'  onchange='priceChange(\""+productIndex+"\")'>
                                        </td>
                                        <td>
                                            <input type='text' name='product-val[]' class='product-val crm-readonly-input' readonly>
                                        </td>
                                        <td>
                                            <input type='text' name='product-tva[]' class='product-tva crm-readonly-input' readonly>
                                        </td>
                                    </tbody>
                                </table>
                                <div class="row" style='justify-content: space-between;'>
                                    <div>
                                        <span>Total fara TVA</span>
                                        <input type="text" name="total-fara-tva" id="total-fara-tva" readonly class="crm-readonly-input" required>
                                    </div>
                                    <div>
                                        <span>Total TVA</span>
                                        <input type="text" name="total-tva" id="total-tva" readonly class="crm-readonly-input" required>
                                    </div>
                                    <div>
                                        <span>Total de plata</span>
                                        <input type="text" name="total-de-plata" id="total-de-plata" readonly class="crm-readonly-input" required>
                                    </div>
                                </div>
                                <div>
                                    <div onclick="openNewProducts();" class="crm-long-btn" style="background-color:#6baa41">Adauga produs</div>
                                    <div id="new-product-container" style="display:none;justify-content: space-around;align-items: center;margin-top:10px">
                                        <div onclick="addProduct(1,event)" class="product-button" >Pachet START-UP</div>
                                        <div class="product-button" onclick="addProduct(2,event)">Pachet OPTIM</div>
                                        <div class="product-button" onclick="addProduct(3,event)">Pachet ADVANCED</div>
                                        <div class="product-button" onclick="addProduct(0,event)">Produs personalizat</div>
                                    </div>
                                </div>
                                
                            </div>
                            
                            <div>

                            </div>
                        

                            <div style='width: max-content;margin:0 auto'>
                            <button class="form-button" type="submit">Genereaza</button>
                                
                            </div>
                       </form> 
                    </div>
            
                </div>
                
            </div>
        </div>
    </div>

    <div id="modal-send-invoice" class="modal">
        <div class="form-box">
            <div class="form-container">
                <div class='btns-box'>
                    <div>
                       
                    </div>
                    <i onclick='closeSendInvoice()' class='fas fa-times'></i>
                </div>
                <div id='view-complete-action-content'>
                    <div>
                        <h1 style="text-align:center">Factura generata cu succes!</h1>
                       <form action="" method="POST" id="crm-check-send-proforma">
                            <input type="text" name="clientId" id="send-invoice-clientId" hidden readonly required >
                            <input type="text" name="number" id="send-invoice-number"  readonly required hidden>
                            
                            <div style="text-align:center">
                                <p>Doresti sa trimiti factura prin email?</p>
                            </div>
                        

                            <div class='crm-action-box-btns' style='width: max-content;margin: 0 auto;'>
                                <div class="crm-long-btn" onclick="closeSendInvoice()" style="background-color:#d94e47">NU</div>
                                <div class="crm-long-btn" style="background-color:#6baa41" onclick="openMailInvoice()">DA</div>

                                
                                
                            </div>
                       </form> 
                    </div>
            
                </div>
                
            </div>
        </div>
    </div>

    <div id="modal-send-mail-invoice" class="modal">
        <div class="form-box">
            <div class="form-container">
                <div class='btns-box'>
                    <div>
                       
                    </div>
                    <i onclick='closeSendInvoice()' class='fas fa-times'></i>
                </div>
                <div id='view-complete-action-content'>
                    <div>
                        <h1 style="text-align:center">Trimite factura prin email</h1>
                       <form action="" method="POST" id="crm-send-invoice">
                            <input type="text" name="clientId" id="send-mail-invoice-clientId" hidden readonly required >
                            <input type="text" name="number" id="send-mail-invoice-number"  readonly required hidden>
                            
                            <div class="input-container" style="width:auto">
                                <label>Subiect</label>
                                <input type="text" name="invoice-mail-subject" required>
                            </div>
                            <div class="input-container" style="width:auto">
                                <label>Continut</label>
                                <textarea type="text" name="invoice-mail-body" required></textarea>
                            </div>
                            <div class="input-container" style="width:auto">
                                <label>Urări</label>
                                <input type="text" name="invoice-mail-wishes" id="invoice-mail-wishes" required>
                            </div>

                            <div class='crm-action-box-btns' style='width: max-content;margin: 0 auto;'>
                                

                                <button type="submit" class="form-button">Trimite</button>
                                
                            </div>
                       </form> 
                    </div>
            
                </div>
                
            </div>
        </div>
    </div>

    <div id="modal-aprove-invoice" class="modal">
        <div class="form-box">
            <div class="form-container">
                <div class='btns-box'>
                    <div>
                       
                    </div>
                    <i onclick='closeAproveInvoice()' class='fas fa-times'></i>
                </div>
                <div id='view-complete-action-content'>
                    <div>
                        <h1 style="text-align:center">Verifica factura</h1>
                        <p style="text-align:center">inainte de a o aproba</p>
                       <form action="" method="POST" id="crm-aprove-invoice-form">
                            <input type="text" name="clientId" id="aprove-invoice-clientId" hidden readonly required >
                            <input type="text" name="number" id="aprove-invoice-number"  readonly required hidden>
                            <br>
                            <div style="display: flex;flex-direction:row;justify-content:flex-end; align-content:center; margin-bottom:5px">
                                <button class="long-rectang-btn gray-btn" type="button" onclick="setContract()">Contract</button>
                                <button class="long-rectang-btn gray-btn" type="button" onclick="setAnexa()">Anexa</button>
                            </div>
                            <div class="proforma-iframe-container">
                                <div class="proforma-iframe-box">
                                    <iframe id="invoice-iframe-view" src="" frameborder="0"></iframe>
                                </div>
                                <div class="proforma-iframe-box">
                                    <iframe id="contract-iframe-view" src="" frameborder="0"></iframe>
                                    <iframe id="anexa-iframe-view" src="" frameborder="0" style="display:none"></iframe>
                                </div>
                            </div>
                            <br>
                            <div style="display: flex;width: 100%;justify-content: center;align-items: center;align-content: center;">
                                <button type="button" class="long-rectang-btn red-btn">Refuză</button>
                                <button type="submit" class="long-rectang-btn green-btn">Aprobă</button>
                            </div>
                            

                       </form> 
                    </div>
            
                </div>
                
            </div>
        </div>
    </div>

    <div id="modal-send-mail-proforma-quick" class="modal">
        <div class="form-box">
            <div class="form-container">
                <div class='btns-box'>
                    <div>
                       
                    </div>
                    <i onclick='closeMailProformaQuick()' class='fas fa-times'></i>
                </div>
                <div id='view-complete-action-content'>
                    <div>
                        <h1 style="text-align:center">Trimite factura</h1>
                       <form action="" method="POST" id="crm-send-proforma-quick">
                            <input type="text" name="clientId" id="send-mail-proforma-clientId-quick" hidden readonly required >
                            <input type="text" name="number" id="send-mail-proforma-number-quick"  readonly required hidden>
                            
                            <div class="input-container" style="width:auto">
                                <label>Subiect</label>
                                <input type="text" name="proforma-mail-subject" required>
                            </div>
                            <div class="input-container" style="width:auto">
                                <label>Continut</label>
                                <textarea type="text" name="proforma-mail-body" required></textarea>
                            </div>
                            <div class="input-container" style="width:auto">
                                <label>Urări</label>
                                <input type="text" name="proforma-mail-wishes" id="proforma-mail-wishes-2" required>
                            </div>

                            <div class='crm-action-box-btns' style='width: max-content;margin: 0 auto;'>
                                

                                <button type="submit" class="form-button">Trimite</button>
                                
                            </div>
                       </form> 
                    </div>
            
                </div>
                
            </div>
        </div>
    </div>

    <div id="loading-screen">

        <img src="/resources/img/di-logo.svg" id="di-logo-loading" alt="">
        <span>Loading</span>
    </div>

</body>

<script src="/admin/admin-js/logout.js"></script>
<script src="/admin/admin-js/session.js"></script>

<script src="/admin/admin-js/menu.js"></script>
<script src="/admin/crm/js/invoices.js"></script>

</html>